<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>shell</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
  background:#000;
  color:#33ff33;
  font-family:'Press Start 2P', monospace;
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}

.screen{
  width:90vw;
  max-width:900px;
  min-height:60vh;
  padding:40px;
  font-size:14px;
  line-height:1.9;
  background:#050505;
  position:relative;
  transform: perspective(900px) rotateX(2deg);
  box-shadow:
    0 0 40px rgba(51,255,51,.25),
    inset 0 0 60px rgba(0,0,0,.8);
}

.glow{
  text-shadow:0 0 4px #33ff33,0 0 12px rgba(51,255,51,.7);
}

.cursor{
  animation: blink 1s steps(1) infinite;
}
@keyframes blink{50%{opacity:0}}

.screen::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background:linear-gradient(
    rgba(255,255,255,.03) 50%,
    rgba(0,0,0,.05) 50%
  );
  background-size:100% 4px;
  mix-blend-mode:overlay;
}
</style>
</head>

<body>

<div class="screen glow">
  <div id="output"></div>
  <div id="prompt">
    <span>C:\></span><span id="input"></span><span class="cursor">_</span>
  </div>
</div>

<script>
/* ===============================
   STATE
================================ */
const output = document.getElementById("output");
const inputEl = document.getElementById("input");

let inputBuffer = "";
let allowInput = false;

/* ===============================
   AUDIO (SAFE)
================================ */
let ctx;
function beep(freq=800,dur=0.03){
  if(!ctx){
    ctx = new (window.AudioContext||window.webkitAudioContext)();
  }
  const o = ctx.createOscillator();
  const g = ctx.createGain();
  o.type="square";
  o.frequency.value=freq;
  g.gain.value=0.04;
  o.connect(g); g.connect(ctx.destination);
  o.start(); o.stop(ctx.currentTime+dur);
}

/* ===============================
   BOOT
================================ */
const bootLines = [
  "Microsoft(R) MS-DOS(R)",
  "Version 6.22",
  "",
  "Initializing system...",
  "Loading memory blocks...",
  "Checking hardware...",
  "",
  "ACCESS GRANTED.",
  "",
  "Type command to continue.",
  ""
];

let l=0,c=0;
const speed=45;

function boot(){
  if(l>=bootLines.length){
    allowInput=true;
    return;
  }

  if(c<bootLines[l].length){
    output.innerHTML += bootLines[l][c];
    beep(700+Math.random()*200);
    c++;
    setTimeout(boot,speed);
  }else{
    output.innerHTML += "<br>";
    l++; c=0;
    setTimeout(boot,speed*6);
  }
}
boot();

/* ===============================
   COMMAND HANDLER
================================ */
function runCommand(cmd){
  const lower = cmd.toLowerCase();

  if(lower==="karlmark1337"){
    sessionStorage.setItem("access_granted","true");
    location.href="/betas/assets";
    return;
  }

  if(lower==="help"){
    output.innerHTML += "Available commands:<br>HELP, CLS, WHOAMI<br>";
    return;
  }

  if(lower==="cls"){
    output.innerHTML="";
    return;
  }

  if(lower==="whoami"){
    output.innerHTML += "USER: KARLMARK<br>";
    return;
  }

  output.innerHTML += "Bad command or file name<br>";
}

/* ===============================
   INPUT
================================ */
document.addEventListener("keydown",e=>{
  if(!allowInput) return;

  beep(600,0.02);

  if(e.key==="Enter"){
    output.innerHTML += "C:\\>"+inputBuffer+"<br>";
    runCommand(inputBuffer);
    inputBuffer="";
    inputEl.textContent="";
    return;
  }

  if(e.key==="Backspace"){
    inputBuffer=inputBuffer.slice(0,-1);
    inputEl.textContent=inputBuffer;
    return;
  }

  if(e.key.length===1){
    inputBuffer+=e.key;
    inputEl.textContent=inputBuffer;
  }
});
</script>

</body>
</html>
